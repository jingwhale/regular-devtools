<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Regular Developer Tools</title>
    <link rel="stylesheet" href="/devtools.css">
</head>

<body>
    <div id="devtoolsInject" class="devtoolsInject"></div>
    
    <script type='template/regular' id='devtoolsView'>
        <div class='regualrDevtools'>
            <div class='devtoolsHeader no-space'>
                <div class="devtoolsHeader-container">
                    <img src='/assets/regular.png' class='devtoolsHeader-img' />
                    <span class='devtoolsHeader-title'>Regular Devtools</span>
                </div>
                <div class="devtoolsHeader-container right">
                    <img src='/assets/refresh.svg' on-click={this.onRefresh()} class='devtoolsHeader-refresh' title="Refresh"/>
                </div>
            </div>
            <elementView ref=elementView isolate/>
            <div class="sidebar">
                <tabs source="{ tabSource }" selected="{ tabSelected }" on-change="{ this.onTabChange( $event ) }"></tabs>
                <div class="sidebar-content">
                    <div r-hide="{ tabSelected !== 'data' }">
                        <stateView ref=stateView isolate />
                    </div>
                    <div r-hide="{ tabSelected !== 'others' }">
                        
                    </div>
                </div>
            </div>
        </div>
    </script>
    <script type='template/regular' id='elementView'>
        <div class='elementView'>
            {#if loading }
                <img src='/assets/loading.svg' class='loading-img' />
            {#else}
                {#if nodes.length > 0}
                {#list nodes as node}
                    <element node={node} level={1}>
                    </element>
                {/list}
                {#else}
                    <div class="warnning">There is no Regular instance detected. Please check if you're using the latest version of Regularjs. </div>
                {/if}
            {/if}
        </div>
    </script>
    <script type='template/regular' id='element'>
        <div class="element purple {selected ? 'selected' : 'element-tag'}"
        style="padding-left:{level*30}px;}" on-click={this.onClick(node)}>
            <div class="borderline"></div>
            <img src="/assets/arrow.svg"
            style="margin-left: -10px;"
            alt="arrow" on-click={opened = !opened}
            class="arrow ele-item {opened ? 'arrow-down' : null} {node.childNodes.length > 0 ? '': 'hide'}"/>
            {#if node.shadowFlag }
            <span class="ele-item ele-include">#include</span>
            {/if}
            {#if node.shadowFlag }
            <div>
            <span class="tag ele-item">&lt;</span>
            <span class="tagname ele-item">{node.name}
            </span>
            <span class="tag ele-item">&gt;</span>
            </div>
            {#else}
            <span class="tag ele-item">&lt;</span>
            <span class="tagname ele-item">{node.name}
            </span>
            <span class="tag ele-item">&gt;</span>
            {/if}
        </div>
        {#if node.childNodes.length > 0} {#list node.childNodes as n}
        <div style={opened ? '' : "display:none;"} class={node.shadowFlag ? 'include-border':null}>
            <element node={n} level={level+1} ></element>
        </div>
        {/list}
        {/if}
        {#if node.childNodes.length > 0}
        <div class="element purple"
        style="padding-left:{level*30}px;{opened ? null : 'display:none;'}">
            <span class="tag ele-item">&lt;/</span>
            <span class="tagname ele-item">{node.name}</span>
            <span class="tag ele-item">&gt;</span>
        </div>
        {/if}
    </script>
    <script type='template/regular' id='stateView'>
        {#if currentNode.inspectable }
            <div class='inspect' on-click={this.onInspectNode()}>
              inspect
            </div>
        {/if}
        <div class='stateView'>
            <div class='stateView-data'>
                {#list Object.keys(currentNode.data) as key}
                    <prop key={key} value={currentNode.data[key]}/>
                {/list}
            </div>
        </div>
    </script>
    <script type='template/regular' id='stateViewProp'>
        <div class='stateView-data'>
            <div class='stateView-data-key no-space'>
                <img src="/assets/arrow.svg"
                style="margin-left: -10px;"
                 alt="arrow" on-click={opened = !opened}
                 class="arrow item {opened ? 'arrow-down' : null} {hasChildren ? '': 'hide'}"/>
                <span class="key item">{key + ':'}&nbsp;</span>
                {#if this.isPrimitive(value)}
                    {#if type === 'String'}
                        <span class='item string'>"{value}"</span>
                    {#else}
                        <span class='item primitive'>{value}</span>
                    {/if}
                {#elseif type === 'Array'}
                    <span class='item others'>Array[{value.length}]</span>
                {#else}
                    <span class='item others'>{type}</span>
                {/if}
            </div>
            {#if opened && hasChildren}
            <div class='stateView-data-props' style='padding-left:20px'>
                {#list Object.keys(value) as k}
                    <prop key={k} value={value[k]} padding={true}/>
                {/list}
            </div>
            {/if}
        </div>
    </script>
    <script type="template/regular" id="tabs">
        <div class="tabs">
            <div class="tabs-header">
                <div class="tabs-header-items">
                    {#list source as s}
                        <div class="tabs-header-item { selected === s.key ? 'selected' : '' }" on-click="{ this.onTabClick( s.key ) }">
                            { s.text }
                        </div>
                    {/list}
                </div>
            </div>
        </div>
    </script>

    <!-- 引入regularjs -->
    <script src="/lib/regular.js"></script>
    <script src="/devtools.js"></script>
</body>

</html>
