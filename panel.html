<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Regular Developer Tools</title>
    <link rel="stylesheet" href="/devtools.css">
</head>

<body>
    <div id="devtoolsInject" class="devtoolsInject"></div>
    <script type='template/regular' id='devtoolsView'>
        <div class='regualrDevtools'>
            <div class='devtoolsHeader'>
                <img src='/assets/regular.png' class='devtoolsHeader-img' />
                <span class='devtoolsHeader-title'>Regular Devtools</span>
            </div>
            <elementView ref=elementView nodes={nodes} localStateMap={localStateMap} />
            <stateView ref=stateView currentNode={currentNode} />
        </div>
    </script>
    <script type='template/regular' id='elementView'>
        <div class='elementView'>
            {#list nodes as node}
              <element node={node} level={1} localState={localStateMap[node.uuid]}>
              </element>
            {/list}
        </div>
    </script>
    <script type='template/regular' id='element'>
        <div class="element purple {localState.selected ? 'selected' : 'element-tag'}" 
        style="padding-left:{level*20}px;}" on-click={this.onClick(node)}>
            <img src="/assets/arrow.svg" 
            style="margin-left: -15px;"
            alt="arrow" on-click={localState.opened=! localState.opened} 
            class="arrow ele-item {localState.opened ? 'arrow-down' : null} {node.childNodes.length > 0 ? '': 'hide'}"/>
            <span class="tag ele-item">&lt;</span>
            <span class="tagname ele-item">{node.name}</span>
            <span class="tag ele-item">&gt;</span>
        </div>
        {#if node.childNodes.length > 0} {#list node.childNodes as n}
        <div style={localState.opened ? null : "display:none;"}>
            <element node={n} level={level+1} localState={this.$root.data.localStateMap[n.uuid]} on-click={this.onClick(1, $event)}></element>
        </div>
        {/list} {/if} {#if node.childNodes.length > 0}
        <div class="element purple" style="padding-left:{level*20}px;{localState.opened ? null : 'display:none;'}">
            <span class="tag ele-item">&lt;/</span>
            <span class="tagname ele-item">{node.name}</span>
            <span class="tag ele-item">&gt;</span>
        </div>
        {/if}
    </script>
    <script type='template/regular' id='stateView'>
        <div class='stateView'>
            <div class="stateView-title-tag purple">
                &lt;{currentNode.name}&gt;
            </div>
            <div class='stateView-title-text'>
                <div class='data'>data</div>
                {#if currentNode.inspectable }
                <div class='inspect no-space cp' on-click={this.onInspectNode()}>
                  <img class='inspect-icon' src="/assets/inspect.svg" alt="inspect"/>
                  <div class='inspect-text'>inspect</div>
                </div>
                {/if}
            </div>
            <div class='stateView-data'>
                {#list Object.keys(currentNode.data) as key}
                    <prop key={key} value={currentNode.data[key]}/>
                {/list}
            </div>
        </div>
    </script>
    <script type='template/regular' id='stateViewProp'>
        <div class='stateView-data'>
            <div class='stateView-data-key no-space'>
                <img src="/assets/arrow.svg" 
                style="margin-left: -13px;"
                 alt="arrow" on-click={opened = !opened} 
                 class="arrow item {opened ? 'arrow-down' : null} {hasChildren ? '': 'hide'}"/>
                <span class="key item">{key + ': '} </span>
                {#if this.isPrimitive(value)}
                    {#if type === 'String'}
                        <span class='item string'>"{value}"</span>
                    {#else}
                        <span class='item primitive'>{value}</span>
                    {/if}
                {#elseif type === 'Array'}
                    <span class='item others'>Array[{value.length}]</span>
                {#else}
                    <span class='item others'>{type}</span>
                {/if}
            </div>
            {#if opened && hasChildren}
            <div class='stateView-data-props' style='padding-left:20px'>
                {#list Object.keys(value) as k}
                    <prop key={k} value={value[k]} padding={true}/>
                {/list}
            </div>
            {/if} 
        </div>
    </script>

    <!-- 引入regularjs -->
    <script src="/lib/regular.js"></script>
    <script src="/devtools.js"></script>
</body>

</html>
